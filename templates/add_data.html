{% extends 'base.html' %}
{% block content %}
<div class="d-flex justify-content-between align-items-center mb-3">
	<h2>Add Data</h2>
</div>

<!-- Flash Messages -->
{% with messages = get_flashed_messages(with_categories=true) %}
	{% if messages %}
		{% for category, message in messages %}
			<div class="alert alert-{{ 'success' if category=='success' else 'danger' }} alert-dismissible fade show" role="alert">
				{{ message }}
				<button type="button" class="btn-close" data-bs-dismiss="alert"></button>
			</div>
		{% endfor %}
	{% endif %}
{% endwith %}

<div class="row g-4">
	<!-- Add Module Form -->
	<div class="col-md-6">
		<div class="card">
			<div class="card-header bg-primary text-white">
				<h5 class="mb-0">ğŸ“š Add Module</h5>
			</div>
			<div class="card-body">
				<form action="/add-module" method="POST">
					<div class="mb-3">
						<label for="module_code" class="form-label">Module Code <span class="text-danger">*</span></label>
						<input type="text" class="form-control" id="module_code" name="code" required placeholder="e.g., CS101">
					</div>
					<button type="submit" class="btn btn-primary w-100">Add Module</button>
				</form>
			</div>
		</div>
	</div>
	
	<!-- Add Task Form -->
	<div class="col-md-6">
		<div class="card">
			<div class="card-header bg-success text-white">
				<h5 class="mb-0">ğŸ“ Add Task/Assignment</h5>
			</div>
			<div class="card-body">
				<form action="/add-task" method="POST">
					<div class="mb-3">
						<label for="task_title" class="form-label">Task Title <span class="text-danger">*</span></label>
						<input type="text" class="form-control" id="task_title" name="title" required placeholder="e.g., Complete Lab Report">
					</div>
					
					<div class="mb-3">
						<label for="task_module" class="form-label">Module <span class="text-danger">*</span></label>
						<select class="form-select" id="task_module" name="module_id" required>
							<option value="">Select a module...</option>
							{% for module in modules %}
								<option value="{{ module.id }}">{{ module.code }}</option>
							{% endfor %}
						</select>
						<div class="form-text">If your module isn't listed, add it first using the form on the left.</div>
					</div>
					
					<div class="mb-3">
						<label for="task_due_date" class="form-label">Due Date <span class="text-danger">*</span></label>
						<input type="date" class="form-control" id="task_due_date" name="due_date" required>
					</div>
					
					<div class="mb-3">
						<label for="task_status" class="form-label">Status</label>
						<select class="form-select" id="task_status" name="status">
							<option value="pending">Pending</option>
							<option value="in_progress">In Progress</option>
							<option value="completed">Completed</option>
						</select>
					</div>
					
					<button type="submit" class="btn btn-success w-100">Add Task</button>
				</form>
			</div>
		</div>
	</div>
</div>

<div class="alert alert-info mt-4">
	<strong>ğŸ’¡ Note:</strong> Tasks are automatically assigned to you ({{ current_user.name }}). After adding tasks here, view them on the <a href="/tasks" class="alert-link">Tasks page</a>.
</div>
{% endblock %}
